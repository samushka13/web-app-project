<!doctype html>

{% extends "layout.html" %}

{% block content %}

<h2>Selaa uutisia</h2>

<!--
    TODO:
    - allow filtering:
        - time
        - zip code
    - admins should be able to archive (save timestamp and user_id)
-->

{% if session.is_admin %}

<form style="display: inline-block;" action="/browse_news">
    {% if request.path == "/browse_news" %}
    <input class="input active" type="submit" value="Kaikki" />
    {% else %}
    <input class="input" type="submit" value="Kaikki" />
    {% endif %}
</form>

<form style="display: inline-block;" action="/browse_news/archived">
    {% if request.path == "/browse_news/archived" %}
    <input class="input active" type="submit" value="Arkistoidut" />
    {% else %}
    <input class="input" type="submit" value="Arkistoidut" />
    {% endif %}
</form>

<form style="display: inline-block;" action="/browse_news/upcoming">
    {% if request.path == "/browse_news/upcoming" %}
    <input class="input active" type="submit" value="Tulossa olevat" />
    {% else %}
    <input class="input" type="submit" value="Tulossa olevat" />
    {% endif %}
</form>

<form style="display: inline-block;" action="/add_news">
    <input class="input" type="submit" value="Lisää uutinen" />
</form>

{% endif %}

{% if news|length == 0 %}

<div class="content flash">
    {% if request.path == "/browse_news/archived" %}
    Ei arkistoituja uutisia
    {% elif request.path == "/browse_news/upcoming" %}
    Ei tulossa olevia uutisia
    {% else %}
    Ei uutisia
    {% endif %}
</div>

{% else %}

{% for item in news %}
    <div class="content">
        <h3>{{ item.title }}</h3>
        <p>{{ item.body }}</p>
        <hr>
        <p>
            {{ (item.created_by + " @ ") if session.is_admin else "" }}
            {{ item.publish_on.strftime("%d.%m.%Y") }}
        </p>

        {% if request.path == "/browse_news/archived" %}
        <p>
            Arkistoinut: {{ item.archived_by if item.archived_by else "-" }} @ 
            {{ item.archived_at.strftime("%d.%m.%Y %H:%M:%S") if item.archived_at else "-" }}
        </p>
        {% endif %}
    </div>
{% endfor %}

{% endif %}

{% endblock %}
