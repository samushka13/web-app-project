<!doctype html>

{% extends "layout.html" %}

{% block content %}

{% if session.is_admin %}

<form class="inlined" action="/notice/acknowledge/{{ notice.id }}" method="post">
    <input class="input" type="submit" value="Merkitse huomioiduksi">
    <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
</form>

<form class="inlined" action="/notice/wip/{{ notice.id }}" method="post">
    <input class="input" type="submit" value="Merkitse tyÃ¶n alle">
    <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
</form>

<form class="inlined" action="/notice/done/{{ notice.id }}" method="post">
    <input class="input" type="submit" value="Merkitse tehdyksi">
    <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
</form>

<form
    class="inlined"
    action="/{{ 'unarchive_notice' if notice.archived_at else 'archive_notice' }}/{{ notice.id }}"
    method="post"
>
    <input
        class="input"
        type="submit"
        value="{{ 'Peru arkistointi' if notice.archived_at else 'Arkistoi' }}"
    >
    <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
</form>
{% endif %}

{% if not notice.archived_at %}
<form
    class="inlined"
    action="/support_notice/{{ notice.id }}"
    method="post"
>
    <input class="input" type="submit" value="Komppaa">
    <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
</form>
{% endif %}

<form class="inlined" action="/browse_notices">
    <input class="input" type="submit" value="Takaisin" />
</form>

<div class="content">
    <h3>"{{ notice.title }}"</h3>
    <hr>
    <p>"{{ notice.body }}"</p>

    {% if notice.street_address or notice.zip_code %}
    <hr>

    {% if notice.street_address %}
    <p>Katuosoite: {{ notice.street_address }}</p>
    {% endif %}

    {% if notice.zip_code %}
    <p>Postinumero: {{ notice.zip_code }}</p>
    {% endif %}

    {% endif %}

    <hr>

    <div class="flex-fill">
        <p>
            {{ (notice.created_by + " @ ") if session.is_admin else "" }}
            {{ notice.created_at.strftime("%d.%m.%Y") }}
        </p>
    </div>
    
    <div class="flex-fill">
        <p>
            {% if notice.total_views == 0 or notice.total_views == 1 %}
            {{ notice.total_views }} {{ 'katselukerta' if notice.total_views == 1 else 'katselukertaa' }}
            {% else %}
            {{ notice.total_views }} katselukertaa | 
            {{ notice.unique_views }} {{ 'katselija' if notice.unique_views == 1 else 'katselijaa' }}
            {% endif %}
        </p>
        <p>
            {% if notice.total_supports == 0 or notice.total_supports == 1 %}
            {{ notice.total_supports }} {{ 'komppaus' if notice.total_supports == 1 else 'komppausta' }}
            {% else %}
            {{ notice.total_supports }} komppausta | 
            {{ notice.unique_supports }} {{ 'komppaaja' if notice.unique_supports == 1 else 'komppaajaa' }}
            {% endif %}
        </p>
    </div>

    {% if session.is_admin and notice.archived_at %}

    <p>
        Arkistoinut: {{ notice.archived_by if notice.archived_by else "-" }} @ 
        {{ notice.archived_at.strftime("%d.%m.%Y %H:%M:%S") if notice.archived_at else "-" }}
    </p>

    {% endif %}
</div>

{% endblock %}
