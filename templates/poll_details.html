<!doctype html>

{% extends "layout.html" %}

{% block content %}

{% if session.is_admin %}
<form
    class="inlined"
    action="/{{ 'unarchive_poll' if poll.archived_at else 'archive_poll' }}/{{ poll.id }}"
    method="post"
    >
    <input
        class="input"
        type="submit"
        value="{{ 'Peru arkistointi' if poll.archived_at else 'Arkistoi' }}"
    />
    <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
</form>
{% endif %}

{% if not poll.archived_at %}
<form class="inlined" action="/vote_for/{{ poll.id }}" method="post">
    <input class="input" type="submit" value="Kannatan">
    <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
</form>

<form class="inlined" action="/vote_against/{{ poll.id }}" method="post">
    <input class="input" type="submit" value="Vastustan">
    <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
</form>
{% endif %}

{% if poll.for != 0 or poll.against != 0 %}
<form class="inlined" action="/browse_polls/details/{{ poll.id }}/analytics">
    <input class="input" type="submit" value="Tutki äänestysjakaumia">
</form>
{% endif %}

<form class="inlined" action="/browse_polls">
    <input class="input" type="submit" value="Selaa kyselyitä" />
</form>

<div class="content">
    <h3>{{ poll.title }}</h3>

    {% if poll.zip_code %}
    <p>{{ poll.zip_code }}</p>
    {% endif %}

    <hr>

    <div class="flex-fill text">
        <div class="inlined">
            Äänestysaika: {{ poll.open_on.strftime("%d.%m.%Y") }} – {{ poll.close_on.strftime("%d.%m.%Y") }}
        </div>
        <div class="inlined">
            Kannattajia: {{ poll.for }} | Vastustajia: {{ poll.against }}
        </div>
    </div>

    {% if session.is_admin and poll.archived_at %}
    <hr>
    <p>
        {{ (poll.created_by + " @ ") if session.is_admin else "" }}
        {{ poll.created_at.strftime("%d.%m.%Y") }}
    </p>
    <p>
        Arkistoinut: {{ poll.archived_by if poll.archived_by else "-" }} @ 
        {{ poll.archived_at.strftime("%d.%m.%Y %H:%M:%S") if poll.archived_at else "-" }}
    </p>
    {% endif %}
</div>

{% endblock %}
